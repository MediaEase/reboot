{% extends 'pages/settings/base.html.twig' %}

{% block title %}Users - {{ app.request.server.get('SITE_NAME') }}{% endblock %}

{% block body %}
    {% import '_macros/settings.html.twig' as settings_macro %}
    {% import '_macros/breadcrumb.html.twig' as breadcrumb %}
    {% import '_macros/form/buttons.html.twig' as form_macros %}


    <div class="max-w-8xl md:mx-auto md:px-auto lg:px-6">
        <div class="xl:pt-[2.3615rem] pt-[15rem]">
            <div class="xl:pl-[25rem]">
                <div class="w-full mx-auto pt-10 xl:max-w-none xl:ml-4 rounded-xl mb-4">
                    {{ breadcrumb.add('Users List', 'https://mediaease.github.io/docs/') }}
                    {{ settings_macro.infobox(
                        'info',
                        'This page allows you to manage users. You can add, edit, and delete users. You can also manage user roles and permissions.',
                        'For detailed information, refer to the <a href="your-documentation-link" class="text-sky-500 dark:text-sky-400 hover:underline">Users</a> section in the documentation.',
                        'external'
                    ) }}
                    {% set unverifiedUsers = users|filter(u => not u.isVerified) %}
                    <div id="content-wrapper" class="relative px-4 pt-6 prose prose-slate mt-8 dark:prose-dark pb-3 mb-4">
                        {% if unverifiedUsers|length > 0 %}
                            <h2 class="text-2xl font-semibold text-gray-900 dark:text-neutral-200 mb-4">Pending Activations ({{ unverifiedUsers|length }})</h2>
                            <div id="pending-activations" class="relative px-4 pt-6 prose prose-slate mt-8 dark:prose-dark pb-3 mb-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {% for u in unverifiedUsers %}
                                        {% include "pages/users/list/component/user_card.html.twig" with {'user': u, 'context': 'approval'} %}
                                    {% endfor %}
                                </div>
                            </div>
                        {% endif %}
                        <h2 class="text-2xl font-semibold text-gray-900 dark:text-neutral-200 mb-4">All Users ({{ users|length }})</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {% for u in users %}
                                {% include "pages/users/list/component/user_card.html.twig" with {'user': u, 'context': 'list'} %}
                            {% endfor %}
                            <!-- Add User Card -->
                            <div class="flex items-center justify-center bg-gray-200/85 dark:bg-gray-900/85 rounded-lg shadow-md hover:shadow-2xl hover:scale-105 transition duration-300 ease-in-out p-4 relative cursor-pointer" data-te-toggle="modal" data-te-target="#addUserModal">
                                <button
                                    type="button"
                                    class="inline-flex items-center rounded-full text-3xl font-medium uppercase leading-normal text-white transition duration-150 ease-in-out"
                                    data-te-ripple-init
                                    data-te-ripple-color="light">
                                    {{ ux_icon('heroicons:plus', {class: 'icon w-24 h-24 fill-white button-icon'}) }}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div data-te-modal-init class="fixed left-0 top-0 z-[1055] hidden h-dvh w-full overflow-y-auto overflow-x-hidden outline-none" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-modal="true" role="dialog">
        <div data-te-modal-dialog-ref class="pointer-events-none relative flex min-h-[calc(100%-0.5rem)] w-1/2 mx-auto translate-y-[-50px] items-center opacity-0 transition-all duration-300 ease-in-out">
            {% include "pages/users/list/modal/modale.html.twig" %}
        </div>
    </div>
{% endblock %}
